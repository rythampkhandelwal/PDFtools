import{G as ce,s as a,b as le,o as I,r as X,g as pe,e as me,c as Y,i as ee,n as P,p as x,d as C,_ as fe,f as te}from"./main-Dzxg2eZZ.js";import"./mobileMenu-CQFcDk7p.js";import"./full-width-CrKHpSp0.js";import"./simple-mode-footer-rW7ABm1-.js";import{J as $}from"./jszip.min-9lSi4Bg2.js";import{P as b}from"./PDFButton-_8Cap8jz.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./index-DMQTJy3b.js";ce.workerSrc=new URL("/assets/pdf.worker.min-qwK7q_zL.mjs",import.meta.url).toString();document.addEventListener("DOMContentLoaded",()=>{let y=!1;const S=document.getElementById("file-input"),h=document.getElementById("drop-zone"),R=document.getElementById("process-btn"),k=document.getElementById("file-display-area"),F=document.getElementById("split-options"),q=document.getElementById("back-to-tools"),w=document.getElementById("split-mode"),W=document.getElementById("range-panel"),O=document.getElementById("visual-select-panel"),H=document.getElementById("even-odd-panel"),B=document.getElementById("zip-option-wrapper"),U=document.getElementById("all-pages-panel"),V=document.getElementById("bookmarks-panel"),G=document.getElementById("n-times-panel"),E=document.getElementById("n-times-warning");q&&q.addEventListener("click",()=>{window.location.href="/"});const N=async()=>{if(a.files.length>0){const e=a.files[0];if(k){k.innerHTML="";const r=document.createElement("div");r.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const n=document.createElement("div");n.className="flex flex-col overflow-hidden";const s=document.createElement("div");s.className="truncate font-medium text-gray-200 text-sm mb-1",s.textContent=e.name;const d=document.createElement("div");d.className="text-xs text-gray-400",d.textContent=`${te(e.size)} • Loading pages...`,n.append(s,d);const o=document.createElement("button");o.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",o.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',o.onclick=()=>{a.files=[],a.pdfDoc=null,N()},r.append(n,o),k.appendChild(r),Y({icons:ee});try{if(!a.pdfDoc){I("Loading PDF...");const i=await X(e);a.pdfDoc=await b.load(i),x()}d.textContent=`${te(e.size)} • ${a.pdfDoc.getPageCount()} pages`}catch(i){console.error("Error loading PDF:",i),P("Error","Failed to load PDF file."),a.files=[],N();return}}F&&F.classList.remove("hidden")}else k&&(k.innerHTML=""),F&&F.classList.add("hidden"),a.pdfDoc=null},ne=async()=>{if(y)return;const e=document.getElementById("page-selector-grid");if(e){y=!0,e.textContent="",le(),I("Rendering page previews...");try{if(!a.pdfDoc)if(a.files.length>0){const d=a.files[0],o=await X(d);a.pdfDoc=await b.load(o)}else throw new Error("No PDF document loaded");const r=await a.pdfDoc.save(),n=await pe({data:r}).promise;await me(n,e,(d,o)=>{const i=document.createElement("div");i.className="page-thumbnail-wrapper p-1 border-2 border-transparent rounded-lg cursor-pointer hover:border-indigo-500 relative",i.dataset.pageIndex=(o-1).toString();const f=document.createElement("img");f.src=d.toDataURL(),f.className="rounded-md w-full h-auto";const m=document.createElement("p");m.className="text-center text-xs mt-1 text-gray-300",m.textContent=`Page ${o}`,i.append(f,m);const L=p=>{p.preventDefault(),p.stopPropagation(),i.classList.contains("selected")?(i.classList.remove("selected","border-indigo-500"),i.classList.add("border-transparent")):(i.classList.add("selected","border-indigo-500"),i.classList.remove("border-transparent"))};return i.addEventListener("click",L),i.addEventListener("touchend",L),i.addEventListener("touchstart",p=>{p.preventDefault()}),i},{batchSize:8,useLazyLoading:!0,lazyLoadMargin:"400px",onProgress:(d,o)=>{I(`Rendering page previews: ${d}/${o}`)},onBatchComplete:()=>{Y({icons:ee})}})}catch(r){console.error("Error rendering visual selector:",r),P("Error","Failed to render page previews."),y=!1}finally{x()}}},A=()=>{a.files=[],a.pdfDoc=null,document.querySelectorAll(".page-thumbnail-wrapper.selected").forEach(d=>{d.classList.remove("selected","border-indigo-500"),d.classList.add("border-transparent")}),y=!1;const e=document.getElementById("page-selector-grid");e&&(e.innerHTML="");const r=document.getElementById("page-range");r&&(r.value="");const n=document.getElementById("split-n-value");n&&(n.value="5");const s=document.querySelector('input[name="split-mode"][value="range"]');s&&(s.checked=!0,s.dispatchEvent(new Event("change"))),w&&(w.value="range",w.dispatchEvent(new Event("change"))),N()},ae=async()=>{const e=w.value,r=document.getElementById("download-as-zip")?.checked||!1;I("Splitting PDF...");try{if(!a.pdfDoc)throw new Error("No PDF document loaded.");const n=a.pdfDoc.getPageCount();let s=[];switch(e){case"range":const o=document.getElementById("page-range").value;if(!o)throw new Error("Choose a valid page range.");const i=o.split(",");for(const t of i){const l=t.trim();if(l.includes("-")){const[c,g]=l.split("-").map(Number);if(isNaN(c)||isNaN(g)||c<1||g>n||c>g)continue;for(let u=c;u<=g;u++)s.push(u-1)}else{const c=Number(l);if(isNaN(c)||c<1||c>n)continue;s.push(c-1)}}break;case"even-odd":const f=document.querySelector('input[name="even-odd-choice"]:checked');if(!f)throw new Error("Please select even or odd pages.");const m=f.value;for(let t=0;t<n;t++)m==="even"&&(t+1)%2===0&&s.push(t),m==="odd"&&(t+1)%2!==0&&s.push(t);break;case"all":s=Array.from({length:n},(t,l)=>l);break;case"visual":s=Array.from(document.querySelectorAll(".page-thumbnail-wrapper.selected")).map(t=>parseInt(t.dataset.pageIndex||"0"));break;case"bookmarks":const{getCpdf:L}=await fe(async()=>{const{getCpdf:t}=await import("./cpdf-helper-mEqAPeAj.js");return{getCpdf:t}},[]),p=await L(),j=await a.pdfDoc.save(),T=p.fromMemory(new Uint8Array(j),"");p.startGetBookmarkInfo(T);const se=p.numberBookmarks(),J=document.getElementById("bookmark-level")?.value,v=[];for(let t=0;t<se;t++){const l=p.getBookmarkLevel(t),c=p.getBookmarkPage(T,t);(J==="all"||l===parseInt(J))&&c>1&&!v.includes(c-1)&&v.push(c-1)}if(p.endGetBookmarkInfo(),p.deletePdf(T),v.length===0)throw new Error("No bookmarks found at the selected level.");v.sort((t,l)=>t-l);const K=new $;for(let t=0;t<v.length;t++){const l=t===0?0:v[t],c=t<v.length-1?v[t+1]-1:n-1,g=await b.create(),u=Array.from({length:c-l+1},(D,_)=>l+_);(await g.copyPages(a.pdfDoc,u)).forEach(D=>g.addPage(D));const M=await g.save();K.file(`split-${t+1}.pdf`,M)}const oe=await K.generateAsync({type:"blob"});C(oe,"split-by-bookmarks.zip"),x(),P("Success","PDF split successfully!","success",()=>{A()});return;case"n-times":const z=parseInt(document.getElementById("split-n-value")?.value||"5");if(z<1)throw new Error("N must be at least 1.");const Q=new $,ie=Math.ceil(n/z);for(let t=0;t<ie;t++){const l=t*z,c=Math.min(l+z-1,n-1),g=Array.from({length:c-l+1},(D,_)=>l+_),u=await b.create();(await u.copyPages(a.pdfDoc,g)).forEach(D=>u.addPage(D));const M=await u.save();Q.file(`split-${t+1}.pdf`,M)}const re=await Q.generateAsync({type:"blob"});C(re,"split-n-times.zip"),x(),P("Success","PDF split successfully!","success",()=>{A()});return}const d=[...new Set(s)];if(d.length===0&&e!=="bookmarks"&&e!=="n-times")throw new Error("No pages were selected for splitting.");if(e==="all"||["range","visual"].includes(e)&&r){I("Creating ZIP file...");const o=new $;for(const f of d){const m=await b.create(),[L]=await m.copyPages(a.pdfDoc,[f]);m.addPage(L);const p=await m.save();o.file(`page-${f+1}.pdf`,p)}const i=await o.generateAsync({type:"blob"});C(i,"split-pages.zip")}else{const o=await b.create();(await o.copyPages(a.pdfDoc,d)).forEach(m=>o.addPage(m));const f=await o.save();C(new Blob([new Uint8Array(f)],{type:"application/pdf"}),"split-document.pdf")}e==="visual"&&(y=!1),P("Success","PDF split successfully!","success",()=>{A()})}catch(n){console.error(n),P("Error",n.message||"Failed to split PDF. Please check your selection.")}finally{x()}},Z=async e=>{e&&e.length>0&&(a.files=[e[0]],await N())};S&&h&&(S.addEventListener("change",e=>{Z(e.target.files)}),h.addEventListener("dragover",e=>{e.preventDefault(),h.classList.add("bg-gray-700")}),h.addEventListener("dragleave",e=>{e.preventDefault(),h.classList.remove("bg-gray-700")}),h.addEventListener("drop",e=>{e.preventDefault(),h.classList.remove("bg-gray-700");const r=e.dataTransfer?.files;if(r){const n=Array.from(r).filter(s=>s.type==="application/pdf"||s.name.toLowerCase().endsWith(".pdf"));if(n.length>0){const s=new DataTransfer;s.items.add(n[0]),Z(s.files)}}}),S.addEventListener("click",()=>{S.value=""})),w&&w.addEventListener("change",e=>{const r=e.target.value;if(r!=="visual"){y=!1;const n=document.getElementById("page-selector-grid");n&&(n.innerHTML="")}if(W?.classList.add("hidden"),O?.classList.add("hidden"),H?.classList.add("hidden"),U?.classList.add("hidden"),V?.classList.add("hidden"),G?.classList.add("hidden"),B?.classList.add("hidden"),E&&E.classList.add("hidden"),r==="range")W?.classList.remove("hidden"),B?.classList.remove("hidden");else if(r==="visual")O?.classList.remove("hidden"),B?.classList.remove("hidden"),ne();else if(r==="even-odd")H?.classList.remove("hidden");else if(r==="all")U?.classList.remove("hidden");else if(r==="bookmarks")V?.classList.remove("hidden"),B?.classList.remove("hidden");else if(r==="n-times"){G?.classList.remove("hidden"),B?.classList.remove("hidden");const n=()=>{if(!a.pdfDoc)return;const s=a.pdfDoc.getPageCount(),d=parseInt(document.getElementById("split-n-value")?.value||"5"),o=s%d;if(o!==0&&E){E.classList.remove("hidden");const i=document.getElementById("n-times-warning-text");i&&(i.textContent=`The PDF has ${s} pages, which is not evenly divisible by ${d}. The last PDF will contain ${o} page(s).`)}else E&&E.classList.add("hidden")};n(),document.getElementById("split-n-value")?.addEventListener("input",n)}}),R&&R.addEventListener("click",ae)});
