import{c as w,i as v,n as g,f as L,o as E,r as p,d as b,p as B}from"./main-Dzxg2eZZ.js";import"./mobileMenu-CQFcDk7p.js";import"./full-width-CrKHpSp0.js";import"./simple-mode-footer-rW7ABm1-.js";import{P as x}from"./PDFButton-_8Cap8jz.js";import"./index-DMQTJy3b.js";let l=[];document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();function u(){w({icons:v});const t=document.getElementById("file-input"),n=document.getElementById("drop-zone"),a=document.getElementById("add-more-btn"),i=document.getElementById("clear-files-btn"),r=document.getElementById("process-btn");t&&t.addEventListener("change",I),n&&(n.addEventListener("dragover",e=>{e.preventDefault(),n.classList.add("bg-gray-700")}),n.addEventListener("dragleave",()=>{n.classList.remove("bg-gray-700")}),n.addEventListener("drop",e=>{e.preventDefault(),n.classList.remove("bg-gray-700");const o=e.dataTransfer?.files;o&&o.length>0&&y(o)}),t?.addEventListener("click",()=>{t&&(t.value="")})),a&&a.addEventListener("click",()=>{t?.click()}),i&&i.addEventListener("click",()=>{l=[],m()}),r&&r.addEventListener("click",C),document.getElementById("back-to-tools")?.addEventListener("click",()=>{window.location.href="/"})}function I(t){const n=t.target;n.files&&n.files.length>0&&y(n.files)}function y(t){const n=Array.from(t).filter(a=>a.type.startsWith("image/"));n.length<t.length&&g("Invalid Files","Some files were skipped. Only image files are allowed."),n.length>0&&(l=[...l,...n],m())}const U=()=>{l=[],m()};function m(){const t=document.getElementById("file-display-area"),n=document.getElementById("file-controls"),a=document.getElementById("jpg-to-pdf-options");!t||!n||!a||(t.innerHTML="",l.length>0?(n.classList.remove("hidden"),a.classList.remove("hidden"),l.forEach((i,r)=>{const e=document.createElement("div");e.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const o=document.createElement("div");o.className="flex items-center gap-2 overflow-hidden";const s=document.createElement("span");s.className="truncate font-medium text-gray-200",s.textContent=i.name;const c=document.createElement("span");c.className="flex-shrink-0 text-gray-400 text-xs",c.textContent=`(${L(i.size)})`,o.append(s,c);const d=document.createElement("button");d.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",d.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',d.onclick=()=>{l=l.filter((f,h)=>h!==r),m()},e.append(o,d),t.appendChild(e)}),w({icons:v})):(n.classList.add("hidden"),a.classList.add("hidden")))}function k(t){return new Promise((n,a)=>{const i=new Blob([t]),r=URL.createObjectURL(i),e=new Image;e.onload=()=>{const o=document.createElement("canvas");o.width=e.naturalWidth,o.height=e.naturalHeight;const s=o.getContext("2d");if(!s)return URL.revokeObjectURL(r),a(new Error("Could not get canvas context"));s.drawImage(e,0,0),o.toBlob(async c=>{if(!c)return a(new Error("Canvas toBlob conversion failed."));const d=await c.arrayBuffer();n(new Uint8Array(d))},"image/jpeg",.9),URL.revokeObjectURL(r)},e.onerror=()=>{URL.revokeObjectURL(r),a(new Error("The provided file could not be loaded as an image. It may be corrupted."))},e.src=r})}function R(t){return new Promise((n,a)=>{const i=new Image,r=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),e=URL.createObjectURL(r);i.onload=()=>{const o=document.createElement("canvas"),s=i.naturalWidth||i.width||800,c=i.naturalHeight||i.height||600;o.width=s,o.height=c;const d=o.getContext("2d");if(!d)return URL.revokeObjectURL(e),a(new Error("Could not get canvas context"));d.fillStyle="white",d.fillRect(0,0,s,c),d.drawImage(i,0,0,s,c),o.toBlob(async f=>{if(URL.revokeObjectURL(e),!f)return a(new Error("Canvas toBlob conversion failed."));const h=await f.arrayBuffer();n(new Uint8Array(h))},"image/png")},i.onerror=()=>{URL.revokeObjectURL(e),a(new Error("Failed to load SVG image"))},i.src=e})}async function C(){if(l.length===0){g("No Files","Please select at least one image file.");return}E("Creating PDF from images...");try{const t=await x.create();for(const a of l)try{if(a.type==="image/svg+xml"||a.name.toLowerCase().endsWith(".svg")){const r=await a.text(),e=await R(r),o=await t.embedPng(e);t.addPage([o.width,o.height]).drawImage(o,{x:0,y:0,width:o.width,height:o.height})}else if(a.type==="image/png"){const r=await p(a),e=await t.embedPng(r);t.addPage([e.width,e.height]).drawImage(e,{x:0,y:0,width:e.width,height:e.height})}else{const r=await p(a);let e;try{e=await t.embedJpg(r)}catch{const c=await k(r);e=await t.embedJpg(c)}t.addPage([e.width,e.height]).drawImage(e,{x:0,y:0,width:e.width,height:e.height})}}catch(i){throw console.error(`Failed to process ${a.name}:`,i),new Error(`Could not process "${a.name}". The file may be corrupted.`)}const n=await t.save();b(new Blob([new Uint8Array(n)],{type:"application/pdf"}),"from_images.pdf"),g("Success","PDF created successfully!","success",()=>{U()})}catch(t){console.error(t),g("Conversion Error",t.message)}finally{B()}}
