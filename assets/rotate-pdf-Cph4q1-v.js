import{G as N,n as y,f as I,c as h,i as b,o as P,g as $,p as E,b as A,e as T,d as R}from"./main-Dzxg2eZZ.js";import"./mobileMenu-CQFcDk7p.js";import"./full-width-CrKHpSp0.js";import"./simple-mode-footer-rW7ABm1-.js";import{P as C,d as B}from"./PDFButton-_8Cap8jz.js";import"./index-DMQTJy3b.js";N.workerSrc=new URL("/assets/pdf.worker.min-qwK7q_zL.mjs",import.meta.url).toString();const e={file:null,pdfDoc:null,pdfJsDoc:null,rotations:[]};function w(){A(),e.file=null,e.pdfDoc=null,e.pdfJsDoc=null,e.rotations=[];const n=document.getElementById("file-display-area");n&&(n.innerHTML="");const a=document.getElementById("tool-options");a&&a.classList.add("hidden");const r=document.getElementById("page-thumbnails");r&&(r.innerHTML="");const o=document.getElementById("file-input");o&&(o.value="");const i=document.getElementById("batch-custom-angle");i&&(i.value="0")}function v(){for(let n=0;n<e.rotations.length;n++){const a=document.getElementById(`page-angle-${n}`);a&&(a.value=e.rotations[n].toString());const r=document.querySelector(`[data-page-index="${n}"]`);if(r){const o=r.querySelector(".thumbnail-wrapper");o&&(o.style.transform=`rotate(${-e.rotations[n]}deg)`)}}}function F(n,a){const r=a-1,o=document.createElement("div");o.className="page-thumbnail relative bg-gray-700 rounded-lg overflow-hidden",o.dataset.pageIndex=r.toString(),o.dataset.pageNumber=a.toString();const i=document.createElement("div");i.className="thumbnail-wrapper flex items-center justify-center p-2 h-36",i.style.transition="transform 0.3s ease",n.className="max-w-full max-h-full object-contain",i.appendChild(n);const f=document.createElement("div");f.className="absolute top-1 left-1 bg-black bg-opacity-60 text-white text-xs px-2 py-1 rounded",f.textContent=`${a}`,o.appendChild(i),o.appendChild(f);const p=document.createElement("div");p.className="flex items-center justify-center gap-1 p-2 bg-gray-800";const m=document.createElement("button");m.className="w-8 h-8 flex items-center justify-center bg-gray-700 hover:bg-gray-600 text-white rounded border border-gray-600 text-sm",m.textContent="−",m.onclick=function(c){c.stopPropagation();const l=document.getElementById(`page-angle-${r}`),u=parseInt(l.value)||0;l.value=(u-1).toString()};const d=document.createElement("input");d.type="number",d.id=`page-angle-${r}`,d.value=e.rotations[r]?.toString()||"0",d.className="w-12 h-8 text-center bg-gray-700 border border-gray-600 text-white rounded text-xs";const s=document.createElement("button");s.className="w-8 h-8 flex items-center justify-center bg-gray-700 hover:bg-gray-600 text-white rounded border border-gray-600 text-sm",s.textContent="+",s.onclick=function(c){c.stopPropagation();const l=document.getElementById(`page-angle-${r}`),u=parseInt(l.value)||0;l.value=(u+1).toString()};const t=document.createElement("button");return t.className="w-8 h-8 flex items-center justify-center bg-gray-700 hover:bg-gray-600 text-white rounded border border-gray-600",t.innerHTML='<i data-lucide="rotate-cw" class="w-4 h-4"></i>',t.onclick=function(c){c.stopPropagation();const l=document.getElementById(`page-angle-${r}`),u=parseInt(l.value)||0;e.rotations[r]=u;const g=o.querySelector(".thumbnail-wrapper");g&&(g.style.transform=`rotate(${-u}deg)`)},p.append(m,d,s,t),o.appendChild(p),setTimeout(function(){h({icons:b})},0),o}async function j(){const n=document.getElementById("page-thumbnails");!n||!e.pdfJsDoc||(n.innerHTML="",await T(e.pdfJsDoc,n,F,{batchSize:8,useLazyLoading:!0,lazyLoadMargin:"200px",eagerLoadBatches:2,onBatchComplete:function(){h({icons:b})}}),h({icons:b}))}async function z(){const n=document.getElementById("file-display-area"),a=document.getElementById("tool-options");if(n)if(n.innerHTML="",e.file){const r=document.createElement("div");r.className="flex items-center justify-between bg-gray-700 p-3 rounded-lg text-sm";const o=document.createElement("div");o.className="flex flex-col overflow-hidden";const i=document.createElement("div");i.className="truncate font-medium text-gray-200 text-sm mb-1",i.textContent=e.file.name;const f=document.createElement("div");f.className="text-xs text-gray-400",f.textContent=`${I(e.file.size)} • Loading...`,o.append(i,f);const p=document.createElement("button");p.className="ml-4 text-red-400 hover:text-red-300 flex-shrink-0",p.innerHTML='<i data-lucide="trash-2" class="w-4 h-4"></i>',p.onclick=function(){w()},r.append(o,p),n.appendChild(r),h({icons:b});try{P("Loading PDF...");const m=await e.file.arrayBuffer();e.pdfDoc=await C.load(m.slice(0),{ignoreEncryption:!0,throwOnInvalidObject:!1}),e.pdfJsDoc=await $({data:m.slice(0)}).promise;const d=e.pdfDoc.getPageCount();e.rotations=new Array(d).fill(0),f.textContent=`${I(e.file.size)} • ${d} pages`,await j(),E(),a&&a.classList.remove("hidden")}catch(m){console.error("Error loading PDF:",m),E(),y("Error","Failed to load PDF file."),w()}}else a&&a.classList.add("hidden")}async function H(){if(!e.pdfDoc||!e.file){y("Error","Please upload a PDF first.");return}P("Applying rotations...");try{const n=e.pdfDoc.getPageCount(),a=await C.create();for(let i=0;i<n;i++){const f=e.rotations[i]||0,p=e.pdfDoc.getPage(i),d=p.getRotation().angle+f;if(d%90===0){const[s]=await a.copyPages(e.pdfDoc,[i]);s.setRotation(B(d)),a.addPage(s)}else{const s=await a.embedPage(p),{width:t,height:c}=s.scale(1),l=d*Math.PI/180,u=Math.abs(Math.cos(l)),g=Math.abs(Math.sin(l)),x=t*u+c*g,L=t*g+c*u,S=a.addPage([x,L]),k=x/2-(t/2*Math.cos(l)-c/2*Math.sin(l)),M=L/2-(t/2*Math.sin(l)+c/2*Math.cos(l));S.drawPage(s,{x:k,y:M,width:t,height:c,rotate:B(d)})}}const r=await a.save(),o=e.file.name.replace(/\.pdf$/i,"");R(new Blob([new Uint8Array(r)],{type:"application/pdf"}),`${o}_rotated.pdf`),y("Success","Rotations applied successfully!","success",function(){w()})}catch(n){console.error(n),y("Error","Could not apply rotations.")}finally{E()}}function D(n){if(n&&n.length>0){const a=n[0];(a.type==="application/pdf"||a.name.toLowerCase().endsWith(".pdf"))&&(e.file=a,z())}}document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("file-input"),a=document.getElementById("drop-zone"),r=document.getElementById("process-btn"),o=document.getElementById("back-to-tools"),i=document.getElementById("rotate-all-left"),f=document.getElementById("rotate-all-right"),p=document.getElementById("batch-decrement"),m=document.getElementById("batch-increment"),d=document.getElementById("batch-apply"),s=document.getElementById("batch-custom-angle");o&&o.addEventListener("click",function(){window.location.href="/"}),i&&i.addEventListener("click",function(){for(let t=0;t<e.rotations.length;t++)e.rotations[t]=e.rotations[t]+90;v()}),f&&f.addEventListener("click",function(){for(let t=0;t<e.rotations.length;t++)e.rotations[t]=e.rotations[t]-90;v()}),p&&s&&p.addEventListener("click",function(){const t=parseInt(s.value)||0;s.value=(t-1).toString()}),m&&s&&m.addEventListener("click",function(){const t=parseInt(s.value)||0;s.value=(t+1).toString()}),d&&s&&d.addEventListener("click",function(){const t=parseInt(s.value)||0;if(t!==0){for(let c=0;c<e.rotations.length;c++)e.rotations[c]=e.rotations[c]+t;v()}}),n&&a&&(n.addEventListener("change",function(t){D(t.target.files)}),a.addEventListener("dragover",function(t){t.preventDefault(),a.classList.add("bg-gray-700")}),a.addEventListener("dragleave",function(t){t.preventDefault(),a.classList.remove("bg-gray-700")}),a.addEventListener("drop",function(t){t.preventDefault(),a.classList.remove("bg-gray-700");const c=t.dataTransfer?.files;if(c&&c.length>0){const l=Array.from(c).filter(function(u){return u.type==="application/pdf"||u.name.toLowerCase().endsWith(".pdf")});if(l.length>0){const u=new DataTransfer;u.items.add(l[0]),D(u.files)}}}),n.addEventListener("click",function(){n.value=""})),r&&r.addEventListener("click",H)});
